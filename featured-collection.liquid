{% comment %}
  Studio Sivad - Featured Collection Section
  Displays featured products in a luxury grid layout
{% endcomment %}

<div class="featured-collection section-padding">
  <div class="container">
    {% if section.settings.title != blank %}
      <div class="section-header text-center">
        <h2 class="section-title">{{ section.settings.title }}</h2>
        {% if section.settings.description != blank %}
          <p class="section-description">{{ section.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    {% if section.settings.collection != blank %}
      {% assign collection = collections[section.settings.collection] %}
      
      <div class="products-grid">
        {% for product in collection.products limit: section.settings.products_to_show %}
          <div class="product-card">
            <div class="product-image">
              {% if product.featured_media %}
                <a href="{{ product.url }}">
                  {{ product.featured_media | image_url: width: 400 | image_tag: 
                     alt: product.title, 
                     loading: 'lazy',
                     class: 'product-img' }}
                </a>
              {% else %}
                <div class="product-placeholder">
                  <svg width="100" height="100" viewBox="0 0 100 100" fill="#ddd">
                    <rect width="100" height="100" fill="currentColor"/>
                  </svg>
                </div>
              {% endif %}
              
              {% if product.compare_at_price > product.price %}
                <span class="sale-badge">Sale</span>
              {% endif %}
            </div>
            
            <div class="product-info">
              <h3 class="product-title">
                <a href="{{ product.url }}">{{ product.title }}</a>
              </h3>
              
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="price-sale">${{ product.price | money_without_currency }}</span>
                  <span class="price-compare">${{ product.compare_at_price | money_without_currency }}</span>
                {% else %}
                  <span class="price">${{ product.price | money_without_currency }}</span>
                {% endif %}
              </div>
              
              <div class="product-actions">
                <a href="{{ product.url }}" class="btn btn-primary">
                  {% if product.metafields.custom.drop_status %}
                    Reserve Now
                  {% else %}
                    View Product
                  {% endif %}
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
      
      {% if collection.products.size > section.settings.products_to_show %}
        <div class="section-footer text-center">
          <a href="{{ collection.url }}" class="btn btn-secondary">View All Products</a>
        </div>
      {% endif %}
    {% else %}
      <div class="text-center">
        <p>No collection selected</p>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .featured-collection {
    padding: 4rem 0;
  }

  .section-header {
    margin-bottom: 3rem;
  }

  .section-title {
    font-size: 2.5rem;
    font-weight: 300;
    color: var(--color-primary, #000);
    margin-bottom: 1rem;
  }

  .section-description {
    font-size: 1.1rem;
    color: var(--text-secondary, #666);
    max-width: 600px;
    margin: 0 auto;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
  }

  .product-card {
    background: white;
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid #f0f0f0;
  }

  .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  }

  .product-image {
    position: relative;
    overflow: hidden;
  }

  .product-img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-card:hover .product-img {
    transform: scale(1.05);
  }

  .product-placeholder {
    width: 100%;
    height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
    color: #ddd;
  }

  .sale-badge {
    position: absolute;
    top: 1rem;
    left: 1rem;
    background: #e74c3c;
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
  }

  .product-info {
    padding: 1.5rem;
  }

  .product-title a {
    color: var(--color-primary, #000);
    text-decoration: none;
    font-size: 1.1rem;
    font-weight: 500;
    line-height: 1.3;
  }

  .product-title a:hover {
    color: var(--color-secondary, #333);
  }

  .product-price {
    margin: 1rem 0;
  }

  .price, .price-sale {
    font-size: 1.2rem;
    font-weight: 500;
    color: var(--color-primary, #000);
  }

  .price-compare {
    font-size: 1rem;
    color: #999;
    text-decoration: line-through;
    margin-left: 0.5rem;
  }

  .product-actions {
    margin-top: 1rem;
  }

  .btn {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 500;
    text-align: center;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    width: 100%;
  }

  .btn-primary {
    background: var(--color-primary, #000);
    color: white;
  }

  .btn-primary:hover {
    background: var(--color-secondary, #333);
    color: white;
  }

  .btn-secondary {
    background: transparent;
    color: var(--color-primary, #000);
    border: 1px solid var(--color-primary, #000);
  }

  .btn-secondary:hover {
    background: var(--color-primary, #000);
    color: white;
  }

  .section-footer {
    margin-top: 2rem;
  }

  @media (max-width: 768px) {
    .products-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .section-title {
      font-size: 2rem;
    }

    .featured-collection {
      padding: 2rem 0;
    }
  }

  @media (max-width: 480px) {
    .products-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

{% schema %}
{
  "name": "Featured Collection",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "default": "Featured Products",
      "label": "Heading"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 8,
      "label": "Number of products to show"
    }
  ],
  "presets": [
    {
      "name": "Featured Collection"
    }
  ]
}
{% endschema %}